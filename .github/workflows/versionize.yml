name: Versionize Job

runs-on: ubuntu-latest

steps:
  - name: Setup git
    run: |
      git config --local user.email "github-actions[bot]@users.noreply.github.com"
      git config --local user.name "github-actions[bot]"

  - name: Install Versionize
    run: dotnet tool install --global Versionize

  - name: Versioning
    id: versionize
    run: versionize --aggregate-pre-releases --skip-dirty
    continue-on-error: true

  - name: No release required
    if: steps.versionize.outcome != 'success'
    run: echo "Skipping Release. No release required."

  - name: Push changes to GitHub
    if: steps.versionize.outcome == 'success'
    uses: ad-m/github-push-action@master
    with:
      github_token: ${{ secrets.GITHUB_TOKEN }}
      branch: ${{ github.ref }}
      tags: true
      force: true
